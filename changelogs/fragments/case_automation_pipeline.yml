# --- Start of changelogs/fragments/case_automation_pipeline.yml
---
major_changes:
  - Introduce new role `rh_case_create` for programmatic Red Hat Support Case creation, completing a major roadmap item.
  - >-
      Implement the **OCP Support Autopilot Pipeline** (`ocp-case-mustgather-pipeline.yml`)
      for end-to-end automated diagnostic submission, handling token refresh, case creation,
      collection, and upload.

minor_changes:
  - 'ocp_must_gather': Implemented **Disconnected/Air-Gapped** environment support via `ocp_disconnected_mode` and `ocp_disconnected_registry`.
  - 'ocp_must_gather': Implemented **Acronym-based Component Selection** (e.g., AAP, ODF) for Must-Gather image lookup, simplifying user input.
  - >-
      'ocp_must_gather': Refactored version retrieval to use **semantic sorting (`sort -V`)**
      and **tiered search logic** for complex operators (e.g., OSSM), ensuring high reliability
      and performance gains.
  - >-
      'rh_case_create': Added logic for **Generalized Case Creation** payload construction to conditionally
      include OpenShift-specific fields, allowing support for any Red Hat product.
  - Introduced new utility playbook `rh_case_create_only.yml` for API-only case creation workflow.

features:
  - 'ocp_must_gather': Added **Cluster-Admin Privilege** and **Disk Space Pre-check** safety assertions for pre-flight validation.
  - >-
      'rh_case_create': Implemented **Structured JSON Logging (`to_nice_json`)** in handlers for clean,
      human-readable output in the AAP console, resolving previous display breaks.
  - 'rh_case_create': Introduced custom Jinja templates for initial case comment (`support_case_create.j2`) and final summary display.

bugfixes:
  - Corrected variable precedence issues that led to "undefined variable" errors in handlers when mixing role defaults and dynamic facts.
  - Resolved ambiguous role resolution by enforcing reliable search paths for internal role calls.

documentation:
  - Updated main `README.md` to reflect all new roles, playbooks, and features.
  - Added centralized documentation file `CASE_OPTIONS.md` for valid API inputs (Product, Type, Severity).
  - Updated `ocp_must_gather` README with detailed safety check and disconnected usage instructions.
...
# --- End of changelogs/fragments/case_automation_pipeline.yml ---
